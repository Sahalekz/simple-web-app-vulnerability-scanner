# ui.py

import tkinter as tk
from tkinter import messagebox
from scanner import BasicScanner

class VulnerabilityScannerUI:
    def __init__(self, root):
        self.root = root
        self.root.title("Vulnerability Scanner")

        # URL Input
        self.url_label = tk.Label(root, text="Enter URL:")
        self.url_label.pack(pady=10)
        self.url_entry = tk.Entry(root, width=50)
        self.url_entry.pack(pady=10)

        # Scan Button
        self.scan_button = tk.Button(root, text="Scan", command=self.start_scan)
        self.scan_button.pack(pady=10)

        # Results
        self.results_label = tk.Label(root, text="Scan Results:")
        self.results_label.pack(pady=10)
        self.results_text = tk.Text(root, height=15, width=80)
        self.results_text.pack(pady=10)

    def start_scan(self):
        url = self.url_entry.get()
        scanner = BasicScanner(url)

        if not scanner.is_valid_url():
            messagebox.showerror("Error", "Invalid URL")
            return

        # Clear previous results
        self.results_text.delete(1.0, tk.END)

        # Start the scan
        self.results_text.insert(tk.END, "Starting scan...\n")
        results = scanner.scan_all()  # This will call all scan methods in order

        # Display individual scan results
        for result in results:
            self.results_text.insert(tk.END, result + "\n")
